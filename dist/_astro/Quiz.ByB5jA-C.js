import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.CRVbtxaI.js";import{A as U}from"./client.Dpvk074T.js";function F(){const[A,E]=s.useState([]),[n,Q]=s.useState([]),[T,j]=s.useState(null),[l,i]=s.useState(0),[d,r]=s.useState(null),[f,m]=s.useState(0),[x,b]=s.useState([]),[u,w]=s.useState(!1),[N,y]=s.useState(!1),[p,v]=s.useState(null),[g,S]=s.useState(0),h=s.useRef(null);s.useEffect(()=>{fetch(U+"/api/soals").then(e=>e.json()).then(e=>{Array.isArray(e.soals)?E(e.soals):console.error("❌ Format JSON tidak sesuai: 'soals' bukan array.")}).catch(e=>console.error("❌ Gagal memuat soal:",e))},[]),s.useEffect(()=>(p&&!u&&(h.current=setInterval(()=>{S(Math.floor((Date.now()-p.getTime())/1e3))},1e3)),()=>{h.current&&clearInterval(h.current)}),[p,u]);const I=e=>{const c=[...A].sort(()=>.5-Math.random()).slice(0,e);Q(c),b(Array(e).fill(null)),j(e),v(new Date),i(0),m(0),r(null)},P=e=>{if(d!==null||!n.length)return;r(e),e===n[l].answer&&m(c=>c+1),b(c=>{const C=[...c];return C[l]=e,C})},k=()=>{l+1<n.length&&(r(null),i(e=>e+1))},R=()=>{b(e=>{const a=[...e];return a[l]=null,a}),k()},J=()=>{if(l>0){const e=l-1,a=x[e];a&&a===n[e].answer&&m(c=>c-1),i(e),r(null)}},q=()=>w(!0),z=e=>{e<n.length&&(i(e),r(x[e]))};if(s.useEffect(()=>{r(x[l])},[l]),s.useEffect(()=>{u&&!N&&(h.current&&clearInterval(h.current),fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:1,score:f,total:n.length,duration:g})}).then(e=>e.json()).then(e=>{console.log("Skor terkirim:",e),y(!0)}))},[u,N,f,g,n.length]),!T)return t.jsxs("div",{className:"text-center mt-10",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Pilih Jumlah Soal"}),t.jsx("div",{className:"flex justify-center gap-4 flex-wrap",children:[10,20,30,50,100].map(e=>t.jsxs("button",{onClick:()=>I(e),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:[e," Soal"]},e))})]});if(u)return t.jsxs("div",{className:"bg-white p-8 rounded shadow-md text-center max-w-md mx-auto mt-10",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Hasil Quiz"}),t.jsxs("p",{className:"text-lg mb-2",children:["Skor Anda: ",f," dari ",n.length]}),t.jsxs("p",{className:"text-sm text-gray-600",children:["Waktu: ",g," detik"]}),t.jsx("button",{onClick:()=>{i(0),r(null),m(0),b([]),w(!1),y(!1),v(null),S(0),j(null)},className:"mt-6 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Ulangi"})]});if(!n[l])return t.jsx("div",{className:"text-center p-10",children:t.jsx("p",{className:"text-lg text-gray-500",children:"Sedang menyiapkan soal..."})});const o=n[l],O=[["a",o.a],["b",o.b],["c",o.c],["d",o.d]];return t.jsxs("div",{className:"flex flex-col md:flex-row gap-4 p-4 max-w-5xl mx-auto",children:[t.jsx("div",{className:"md:w-1/3 w-full",children:t.jsxs("div",{className:"bg-white rounded-xl shadow p-4",children:[t.jsx("h2",{className:"text-sm font-semibold mb-4 text-gray-700",children:"Nomor Soal"}),t.jsx("div",{className:"grid grid-cols-5 gap-x-1 gap-y-2",children:n.map((e,a)=>t.jsx("button",{onClick:()=>z(a),className:`w-9 h-9 rounded-full text-xs font-bold ${a===l?"bg-blue-500 text-white":x[a]!==null?"bg-green-500 text-white":"bg-gray-300 text-black"}`,children:a+1},a))})]})}),t.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-full md:w-4/5",children:[t.jsx("div",{className:"flex justify-end mb-4",children:t.jsx("button",{onClick:q,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Selesai"})}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:["Soal ",l+1," dari ",n.length]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:"bg-blue-500 h-3 rounded-full transition-all",style:{width:`${(l+1)/n.length*100}%`}})})]}),t.jsxs("div",{className:"text-sm text-gray-500 mb-4 text-right",children:["Waktu: ",g," detik"]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-base font-bold text-gray-700 mb-2",children:"Pertanyaan:"}),t.jsx("h2",{className:"text-lg font-medium text-gray-900",children:o.question})]}),t.jsx("ul",{className:"space-y-2",children:O.map(([e,a])=>t.jsxs("li",{className:`p-3 rounded cursor-pointer border transition flex items-start gap-2 ${d!==null?e===o.answer?"bg-green-200 border-green-600":e===d?"bg-red-200 border-red-600":"bg-white border-gray-300":"hover:bg-blue-100 border-gray-300"}`,onClick:()=>P(e),children:[t.jsxs("span",{className:"font-bold",children:[e.toUpperCase(),"."]}),t.jsx("span",{children:a})]},e))}),d!==null&&t.jsxs("div",{className:"mt-4 p-4 bg-yellow-100 border-l-4 border-yellow-500 text-gray-800 rounded",children:[t.jsx("strong",{children:"Pembahasan:"})," ",o.explanation]}),t.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[l>0?t.jsx("button",{onClick:J,className:"px-4 py-2 bg-gray-300 text-black rounded hover:bg-gray-400",children:"Kembali"}):t.jsx("div",{}),t.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[t.jsx("button",{onClick:R,className:"px-4 py-2 bg-yellow-400 text-black rounded hover:bg-yellow-500",children:"Lewati"}),d!==null&&l+1<n.length&&t.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Berikutnya"})]})]})]})]})}export{F as default};
